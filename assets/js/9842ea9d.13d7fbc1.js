"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[42703],{15680:(e,n,t)=>{t.d(n,{xA:()=>u,yg:()=>g});var a=t(96540);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},y=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=p(t),y=r,g=d["".concat(s,".").concat(y)]||d[y]||c[y]||i;return t?a.createElement(g,o(o({ref:n},u),{},{components:t})):a.createElement(g,o({ref:n},u))}));function g(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=y;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[d]="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}y.displayName="MDXCreateElement"},30020:(e,n,t)=>{t.d(n,{A:()=>c});var a=t(96540),r=t(20053);const i={tabItem:"tabItem_Ymn6"};var o=Object.defineProperty,l=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,u=(e,n,t)=>n in e?o(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,d=(e,n)=>{for(var t in n||(n={}))s.call(n,t)&&u(e,t,n[t]);if(l)for(var t of l(n))p.call(n,t)&&u(e,t,n[t]);return e};function c({children:e,hidden:n,className:t}){return a.createElement("div",d({role:"tabpanel",className:(0,r.A)(i.tabItem,t)},{hidden:n}),e)}},37376:(e,n,t)=>{t.d(n,{A:()=>R});var a=t(96540),r=t(20053),i=t(21162),o=t(56347),l=t(56415),s=t(12388),p=t(95072),u=Object.defineProperty,d=Object.defineProperties,c=Object.getOwnPropertyDescriptors,y=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,h=(e,n,t)=>n in e?u(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,b=(e,n)=>{for(var t in n||(n={}))g.call(n,t)&&h(e,t,n[t]);if(y)for(var t of y(n))m.call(n,t)&&h(e,t,n[t]);return e},f=(e,n)=>d(e,c(n));function v(e){return function(e){var n,t;return null!=(t=null==(n=a.Children.map(e,(e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})))?void 0:n.filter(Boolean))?t:[]}(e).map((({props:{value:e,label:n,attributes:t,default:a}})=>({value:e,label:n,attributes:t,default:a})))}function N(e){const{values:n,children:t}=e;return(0,a.useMemo)((()=>{const e=null!=n?n:v(t);return function(e){const n=(0,s.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function _({value:e,tabValues:n}){return n.some((n=>n.value===e))}function z({queryString:e=!1,groupId:n}){const t=(0,o.W6)(),r=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=n?n:null}({queryString:e,groupId:n});return[(0,l.aZ)(r),(0,a.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(t.location.search);n.set(r,e),t.replace(f(b({},t.location),{search:n.toString()}))}),[r,t])]}function w(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,i=N(e),[o,l]=(0,a.useState)((()=>function({defaultValue:e,tabValues:n}){var t;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!_({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const a=null!=(t=n.find((e=>e.default)))?t:n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:i}))),[s,u]=z({queryString:t,groupId:r}),[d,c]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,r]=(0,p.Dv)(n);return[t,(0,a.useCallback)((e=>{n&&r.set(e)}),[n,r])]}({groupId:r}),y=(()=>{const e=null!=s?s:d;return _({value:e,tabValues:i})?e:null})();(0,a.useLayoutEffect)((()=>{y&&l(y)}),[y]);return{selectedValue:o,selectValue:(0,a.useCallback)((e=>{if(!_({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),c(e)}),[u,c,i]),tabValues:i}}var k=t(42517);const O={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var T=Object.defineProperty,x=Object.defineProperties,C=Object.getOwnPropertyDescriptors,E=Object.getOwnPropertySymbols,P=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable,D=(e,n,t)=>n in e?T(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,j=(e,n)=>{for(var t in n||(n={}))P.call(n,t)&&D(e,t,n[t]);if(E)for(var t of E(n))S.call(n,t)&&D(e,t,n[t]);return e},I=(e,n)=>x(e,C(n));function A({className:e,block:n,selectedValue:t,selectValue:o,tabValues:l}){const s=[],{blockElementScrollPositionUntilNextRender:p}=(0,i.a_)(),u=e=>{const n=e.currentTarget,a=s.indexOf(n),r=l[a].value;r!==t&&(p(n),o(r))},d=e=>{var n,t;let a=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=s.indexOf(e.currentTarget)+1;a=null!=(n=s[t])?n:s[0];break}case"ArrowLeft":{const n=s.indexOf(e.currentTarget)-1;a=null!=(t=s[n])?t:s[s.length-1];break}}null==a||a.focus()};return a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},e)},l.map((({value:e,label:n,attributes:i})=>a.createElement("li",I(j({role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,key:e,ref:e=>s.push(e),onKeyDown:d,onClick:u},i),{className:(0,r.A)("tabs__item",O.tabItem,null==i?void 0:i.className,{"tabs__item--active":t===e})}),null!=n?n:e))))}function V({lazy:e,children:n,selectedValue:t}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find((e=>e.props.value===t));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return a.createElement("div",{className:"margin-top--md"},r.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==t}))))}function q(e){const n=w(e);return a.createElement("div",{className:(0,r.A)("tabs-container",O.tabList)},a.createElement(A,j(j({},e),n)),a.createElement(V,j(j({},e),n)))}function R(e){const n=(0,k.A)();return a.createElement(q,j({key:String(n)},e))}},46037:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>v,contentTitle:()=>b,default:()=>w,frontMatter:()=>h,metadata:()=>f,toc:()=>N});var a=t(15680),r=t(37376),i=t(30020),o=Object.defineProperty,l=Object.defineProperties,s=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,c=(e,n,t)=>n in e?o(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,y=(e,n)=>{for(var t in n||(n={}))u.call(n,t)&&c(e,t,n[t]);if(p)for(var t of p(n))d.call(n,t)&&c(e,t,n[t]);return e},g=(e,n)=>l(e,s(n)),m=(e,n)=>{var t={};for(var a in e)u.call(e,a)&&n.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&p)for(var a of p(e))n.indexOf(a)<0&&d.call(e,a)&&(t[a]=e[a]);return t};const h={sidebar_position:1},b="Deploy a node",f={unversionedId:"installation/deploy-a-node",id:"installation/deploy-a-node",title:"Deploy a node",description:"A node is a managed service for pipelines and storage.",source:"@site/docs/installation/deploy-a-node.md",sourceDirName:"installation",slug:"/installation/deploy-a-node",permalink:"/next/installation/deploy-a-node",draft:!1,editUrl:"https://github.com/tenzir/tenzir/tree/main/web/docs/installation/deploy-a-node.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"docsSidebar",previous:{title:"Size a node",permalink:"/next/installation/size-a-node"},next:{title:"Update a node",permalink:"/next/installation/update-a-node"}},v={},N=[{value:"Install a node",id:"install-a-node",level:2},{value:"Docker",id:"docker",level:3},{value:"Linux",id:"linux",level:3},{value:"macOS",id:"macos",level:3},{value:"Start a node",id:"start-a-node",level:2},{value:"Stop a node",id:"stop-a-node",level:2},{value:"Automate the deployment",id:"automate-the-deployment",level:2},{value:"systemd",id:"systemd",level:3},{value:"Prepare the host system",id:"prepare-the-host-system",level:4},{value:"Configure the unit",id:"configure-the-unit",level:4},{value:"Ansible",id:"ansible",level:3},{value:"Example",id:"example",level:4},{value:"Variables",id:"variables",level:4},{value:"<code>tenzir_config_dir</code> (required)",id:"tenzir_config_dir-required",level:5},{value:"<code>tenzir_read_write_paths</code>",id:"tenzir_read_write_paths",level:5},{value:"<code>tenzir_archive</code>",id:"tenzir_archive",level:5},{value:"<code>tenzir_debian_package</code>",id:"tenzir_debian_package",level:5}],_={toc:N},z="wrapper";function w(e){var n=e,{components:t}=n,o=m(n,["components"]);return(0,a.yg)(z,g(y(y({},_),o),{components:t,mdxType:"MDXLayout"}),(0,a.yg)("h1",y({},{id:"deploy-a-node"}),"Deploy a node"),(0,a.yg)("p",null,"A ",(0,a.yg)("em",{parentName:"p"},"node")," is a managed service for pipelines and storage."),(0,a.yg)("h2",y({},{id:"install-a-node"}),"Install a node"),(0,a.yg)("p",null,"Start at ",(0,a.yg)("a",y({parentName:"p"},{href:"https://app.tenzir.com"}),"app.tenzir.com")," and click ",(0,a.yg)("em",{parentName:"p"},"Add")," in the nodes\npane. Then select your platform."),(0,a.yg)("h3",y({},{id:"docker"}),"Docker"),(0,a.yg)("p",null,"We provide Docker images and a Docker Compose file for a container setup.\nInstall a node as follows:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Enter a name for your node and click the download button to obtain the\n",(0,a.yg)("inlineCode",{parentName:"li"},"docker-compose.NODE.yaml")," configuration file where ",(0,a.yg)("inlineCode",{parentName:"li"},"NODE")," is the name you\nentered for your node."),(0,a.yg)("li",{parentName:"ol"},"Run",(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"docker compose -f docker-compose.NODE.yaml up\n")))),(0,a.yg)("p",null,"Edit the Docker Compose file and change ",(0,a.yg)("a",y({parentName:"p"},{href:"/next/configuration#environment-variables"}),"environment\nvariables")," to adjust the\nconfiguration."),(0,a.yg)("h3",y({},{id:"linux"}),"Linux"),(0,a.yg)("p",null,"We offer a native deployment on various Linux distributions.\nInstall a node as follows:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Enter a name for your node and click the download button to obtain a\n",(0,a.yg)("inlineCode",{parentName:"li"},"platform.yaml")," configuration file."),(0,a.yg)("li",{parentName:"ol"},"Move the ",(0,a.yg)("inlineCode",{parentName:"li"},"platform.yaml")," to ",(0,a.yg)("inlineCode",{parentName:"li"},"<sysconfdir>/tenzir/plugin/platform.yaml")," so\nthat the node can find it during startup where ",(0,a.yg)("inlineCode",{parentName:"li"},"<sysconfdir>")," might be\n",(0,a.yg)("inlineCode",{parentName:"li"},"/etc"),". See the ",(0,a.yg)("a",y({parentName:"li"},{href:"/next/configuration#configuration-files"}),"configuration files\ndocumentation")," for more options."),(0,a.yg)("li",{parentName:"ol"},"Run our installer to install a binary package on any Linux distribution:",(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"curl https://get.tenzir.app | sh\n")))),(0,a.yg)("p",null,"The installer script asks for confirmation before performing the installation.\nIf you prefer a manual installation you can also perform the installer steps\nyourself."),(0,a.yg)(r.A,{mdxType:"Tabs"},(0,a.yg)(i.A,{value:"debian",label:"Debian",mdxType:"TabItem"},(0,a.yg)("p",null,"Download the latest ",(0,a.yg)("a",y({parentName:"p"},{href:"https://github.com/tenzir/tenzir/releases/latest/download/tenzir-static-amd64-linux.deb"}),"Debian package")," and install it via\n",(0,a.yg)("inlineCode",{parentName:"p"},"dpkg"),":"),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"dpkg -i tenzir-static-amd64-linux.deb\n")),(0,a.yg)("p",null,"You can uninstall the Tenzir package as follows:"),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"apt-get remove tenzir\n")),(0,a.yg)("p",null,"Use purge instead of remove if you also want to delete the state directory and\nleave no trace:"),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"apt-get purge tenzir\n"))),(0,a.yg)(i.A,{value:"rpm_based",label:"RPM-based (RedHat, OpenSUSE, Fedora)",mdxType:"TabItem"},(0,a.yg)("p",null,"Download the latest ",(0,a.yg)("a",y({parentName:"p"},{href:"https://github.com/tenzir/tenzir/releases/latest/download/tenzir-static-amd64-linux.rpm"}),"RPM package")," and install it via\n",(0,a.yg)("inlineCode",{parentName:"p"},"rpm"),":"),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"rpm -i tenzir-static-amd64-linux.rpm\n"))),(0,a.yg)(i.A,{value:"nix",label:"Nix",mdxType:"TabItem"},(0,a.yg)("p",null,"Use our ",(0,a.yg)("inlineCode",{parentName:"p"},"flake.nix"),":"),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"nix run github:tenzir/tenzir/stable\n")),(0,a.yg)("p",null,"Install Tenzir by adding ",(0,a.yg)("inlineCode",{parentName:"p"},"github:tenzir/tenzir/stable")," to your flake inputs, or\nuse your preferred method to include third-party modules on classic NixOS.")),(0,a.yg)(i.A,{value:"any",label:"Any",mdxType:"TabItem"},(0,a.yg)("p",null,"Download a tarball with our ",(0,a.yg)("a",y({parentName:"p"},{href:"https://github.com/tenzir/tenzir/releases/latest/download/tenzir-static-x86_64-linux.tar.gz"}),"static binary")," for all Linux\ndistributions and unpack it into ",(0,a.yg)("inlineCode",{parentName:"p"},"/opt/tenzir"),":"),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"tar xzf tenzir-static-x86_64-linux.tar.gz -C /\n")),(0,a.yg)("p",null,"We also offer prebuilt statically linked binaries for every Git commit to the\n",(0,a.yg)("inlineCode",{parentName:"p"},"main")," branch."),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"curl -O https://storage.googleapis.com/tenzir-dist-public/packages/main/tarball/tenzir-static-main.gz\n")))),(0,a.yg)("h3",y({},{id:"macos"}),"macOS"),(0,a.yg)("p",null,"Please use Docker ",(0,a.yg)("a",y({parentName:"p"},{href:"https://levelup.gitconnected.com/docker-on-apple-silicon-mac-how-to-run-x86-containers-with-rosetta-2-4a679913a0d5"}),"with\nRosetta"),"\nuntil we offer a native package."),(0,a.yg)("h2",y({},{id:"start-a-node"}),"Start a node"),(0,a.yg)("admonition",y({},{title:"Implicit start with Docker",type:"info"}),(0,a.yg)("p",{parentName:"admonition"},"You can skip this step if you use ",(0,a.yg)("a",y({parentName:"p"},{href:"#docker"}),"Docker")," because ",(0,a.yg)("inlineCode",{parentName:"p"},"docker compose up"),"\nalready starts a node for you.")),(0,a.yg)("p",null,"Run the ",(0,a.yg)("inlineCode",{parentName:"p"},"tenzir-node")," executable to start a node:"),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"tenzir-node\n")),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{}),"      _____ _____ _   _ ________ ____\n     |_   _| ____| \\ | |__  /_ _|  _ \\\n       | | |  _| |  \\| | / / | || |_) |\n       | | | |___| |\\  |/ /_ | ||  _ <\n       |_| |_____|_| \\_/____|___|_| \\_\\\n\n          v4.0.0-rc6-0-gf193b51f1f\nVisit https://app.tenzir.com to get started.\n\n[16:50:26.741] node listens for node-to-node connections on tcp://127.0.0.1:5158\n[16:50:26.982] node connected to platform via wss://ws.tenzir.app:443/production\n")),(0,a.yg)("p",null,"This will spawn a blocking process that listens by default for node-to-node\nconnections on the TCP endpoint ",(0,a.yg)("inlineCode",{parentName:"p"},"127.0.0.1:5158"),". Select a different endpoint\nvia the ",(0,a.yg)("inlineCode",{parentName:"p"},"tenzir.endpoint")," option, e.g., bind to an IPv6 address:"),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"tenzir-node --endpoint=[::1]:42000\n")),(0,a.yg)("p",null,"Set ",(0,a.yg)("inlineCode",{parentName:"p"},"tenzir.endpoint")," to ",(0,a.yg)("inlineCode",{parentName:"p"},"false")," to disable the endpoint, making the node\nexclusively accessible through the Tenzir Platform. This effectively prevents\nconnections from other ",(0,a.yg)("inlineCode",{parentName:"p"},"tenzir")," or ",(0,a.yg)("inlineCode",{parentName:"p"},"tenzir-node")," processes."),(0,a.yg)("h2",y({},{id:"stop-a-node"}),"Stop a node"),(0,a.yg)("p",null,"There exist two ways stop a server:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Hit CTRL+C in the same TTY where you ran ",(0,a.yg)("inlineCode",{parentName:"li"},"tenzir-node"),"."),(0,a.yg)("li",{parentName:"ol"},"Send the process a SIGINT or SIGTERM signal, e.g., via\n",(0,a.yg)("inlineCode",{parentName:"li"},"pkill -2 tenzir-node"),".")),(0,a.yg)("p",null,"Sending the process a SIGTERM is the same as hitting CTRL+C."),(0,a.yg)("h2",y({},{id:"automate-the-deployment"}),"Automate the deployment"),(0,a.yg)("p",null,"Use ",(0,a.yg)("a",y({parentName:"p"},{href:"#systemd"}),"systemd")," or ",(0,a.yg)("a",y({parentName:"p"},{href:"#ansible"}),"Ansible")," to automate the deployment of a\nnode."),(0,a.yg)("h3",y({},{id:"systemd"}),"systemd"),(0,a.yg)("p",null,"The Tenzir package bundles a systemd service unit under\n",(0,a.yg)("inlineCode",{parentName:"p"},"<extraction_path>/lib/systemd/system/tenzir-node.service"),". The service is\nsandboxed and runs with limited privileges."),(0,a.yg)("h4",y({},{id:"prepare-the-host-system"}),"Prepare the host system"),(0,a.yg)("p",null,"Please note that all subsequent commands require ",(0,a.yg)("inlineCode",{parentName:"p"},"root")," privileges. The service\nrequires a user and group called ",(0,a.yg)("inlineCode",{parentName:"p"},"tenzir"),". You can create them as follows."),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"useradd --system --user-group tenzir\n")),(0,a.yg)("p",null,"Once the user exists, you should create the directory for Tenzir's persistent\ndata and change the permissions such that it is owned by the new ",(0,a.yg)("inlineCode",{parentName:"p"},"tenzir")," user:"),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"mkdir -p /var/lib/tenzir\nchown -R tenzir:tenzir /var/lib/tenzir\n")),(0,a.yg)("h4",y({},{id:"configure-the-unit"}),"Configure the unit"),(0,a.yg)("p",null,"Locate the lines beginning with ",(0,a.yg)("inlineCode",{parentName:"p"},"ExecStart=")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"ExecStop=")," at the bottom\nof the ",(0,a.yg)("inlineCode",{parentName:"p"},"[Service]")," section in the unit file. Depending on your installation path\nyou might need to change the location of the ",(0,a.yg)("inlineCode",{parentName:"p"},"tenzir")," binary."),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{}),"ExecStart=/path/to/tenzir start\n")),(0,a.yg)("p",null,"In case your Tenzir deployment needs elevated privileges, e.g., to capture\npackets, you can provide them as follows:"),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-ini"}),"CapabilityBoundingSet=CAP_NET_RAW\nAmbientCapabilities=CAP_NET_RAW\n")),(0,a.yg)("p",null,"Then link the unit file to your systemd search path:"),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"systemctl link tenzir-node.service\n")),(0,a.yg)("p",null,"To have the service start up automatically on system boot, ",(0,a.yg)("inlineCode",{parentName:"p"},"enable")," it via\n",(0,a.yg)("inlineCode",{parentName:"p"},"systemd"),". Otherwise, just ",(0,a.yg)("inlineCode",{parentName:"p"},"start")," it to run it immediately."),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-bash"}),"systemctl enable tenzir-node\nsystemctl start tenzir-node\n")),(0,a.yg)("h3",y({},{id:"ansible"}),"Ansible"),(0,a.yg)("p",null,"The Ansible role for Tenzir allows for easy integration of Tenzir into\nexisting Ansible setups. The role uses either the Tenzir Debian package or\nthe tarball installation method depending on which is appropriate for the\ntarget environment. The role definition is in the\n",(0,a.yg)("a",y({parentName:"p"},{href:"https://github.com/tenzir/tenzir/tree/main/ansible/roles/tenzir"}),(0,a.yg)("inlineCode",{parentName:"a"},"ansible/roles/tenzir"))," directory of the Tenzir\nrepository. You need a local copy of this directory so you can use it in your\nplaybook."),(0,a.yg)("h4",y({},{id:"example"}),"Example"),(0,a.yg)("p",null,"This example playbook shows how to run a Tenzir service on the machine\n",(0,a.yg)("inlineCode",{parentName:"p"},"example_tenzir_server"),":"),(0,a.yg)("pre",null,(0,a.yg)("code",y({parentName:"pre"},{className:"language-yaml"}),"- name: Deploy Tenzir\n  become: true\n  hosts: example_tenzir_server\n  remote_user: example_ansible_user\n  roles:\n    - role: tenzir\n      vars:\n        tenzir_config_dir: ./tenzir\n        tenzir_read_write_paths: [ /tmp ]\n        tenzir_archive: ./tenzir.tar.gz\n        tenzir_debian_package: ./tenzir.deb\n")),(0,a.yg)("h4",y({},{id:"variables"}),"Variables"),(0,a.yg)("h5",y({},{id:"tenzir_config_dir-required"}),(0,a.yg)("inlineCode",{parentName:"h5"},"tenzir_config_dir")," (required)"),(0,a.yg)("p",null,"A path to directory containing a ",(0,a.yg)("a",y({parentName:"p"},{href:"/next/configuration"}),(0,a.yg)("inlineCode",{parentName:"a"},"tenzir.yaml")),"\nrelative to the playbook."),(0,a.yg)("h5",y({},{id:"tenzir_read_write_paths"}),(0,a.yg)("inlineCode",{parentName:"h5"},"tenzir_read_write_paths")),(0,a.yg)("p",null,"A list of paths that Tenzir shall be granted access to in addition to its own\nstate and log directories."),(0,a.yg)("h5",y({},{id:"tenzir_archive"}),(0,a.yg)("inlineCode",{parentName:"h5"},"tenzir_archive")),(0,a.yg)("p",null,"A tarball of Tenzir structured like those that can be downloaded from the\n",(0,a.yg)("a",y({parentName:"p"},{href:"https://github.com/tenzir/tenzir/releases"}),"GitHub Releases Page"),". This is used\nfor target distributions that are not based on the ",(0,a.yg)("inlineCode",{parentName:"p"},"apt")," package manager."),(0,a.yg)("h5",y({},{id:"tenzir_debian_package"}),(0,a.yg)("inlineCode",{parentName:"h5"},"tenzir_debian_package")),(0,a.yg)("p",null,"A Debian package (",(0,a.yg)("inlineCode",{parentName:"p"},".deb"),"). This package is used for Debian and Debian based\nLinux distributions."))}w.isMDXComponent=!0}}]);